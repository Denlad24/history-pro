modules:
  macro:
    - key: historyPro-macro
      function: main
      title: HistoryPro
      description: Displays page version history with custom change tracking
      resolver:
        function: resolver
      render: native

  function:
    - key: main
      handler: index.run

    - key: resolver
      handler: index.resolver

    - key: get-page-version
      handler: index.getPageVersion

    - key: save-entry
      handler: index.saveEntry

    - key: delete-entry
      handler: index.deleteEntry

    - key: get-entries
      handler: index.getEntries

    - key: save-pending-entry
      handler: index.savePendingEntry

    - key: get-pending-entry
      handler: index.getPendingEntry

    - key: finalize-pending-entry
      handler: index.finalizePendingEntry

    - key: clear-pending-entry
      handler: index.clearPendingEntry

resources:
  - key: run
    path: src/frontend/index.js
app:
  runtime:
    name: nodejs22.x
    memoryMB: 256
    architecture: arm64
  id: ari:cloud:ecosystem::app/746307e6-5515-41bc-aa3a-82798c4d8506

permissions:
  scopes:
    - read:page:confluence
    - read:content:confluence
    - read:content-details:confluence
    - read:confluence-user
    - storage:app